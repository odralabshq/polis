# ClamAV daemon configuration for Polis
# Limits aligned with squidclamav maxsize (200M)

LogFile /var/log/clamav/clamd.log
LogTime yes
LocalSocket /tmp/clamd.sock
TCPSocket 3310
User clamav

# ---------------------------------------------------------------------------
# Size limits — aligned with squidclamav maxsize
# ---------------------------------------------------------------------------
# StreamMaxLength: max data accepted over INSTREAM (what c-icap sends).
# Must be >= squidclamav maxsize so c-icap never streams more than clamd accepts.
StreamMaxLength 200M

# MaxFileSize: max size of a single file within an archive to scan.
MaxFileSize 200M

# MaxScanSize: total data scanned per archive (sum of all files inside).
# Keep at default 400M — archives can contain many small files.
MaxScanSize 400M

# CRITICAL: Alert when files exceed limits instead of silently returning OK.
# Without this, oversized files get "OK" even though they weren't scanned.
AlertExceedsMax yes
