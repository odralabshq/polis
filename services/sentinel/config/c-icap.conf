# C-ICAP Configuration for polis v0.3.0
# Two active modules: DLP (REQMOD) + Sentinel RESPMOD (ClamAV + OTT)

PidFile /var/run/c-icap/c-icap.pid
CommandsSocket /var/run/c-icap/c-icap.ctl
Timeout 300
StartServers 3
MaxServers 10
MinSpareThreads 10
MaxSpareThreads 20
ThreadsPerChild 20

# Debug level (0=critical, 1=warning, 3=info, 5=verbose)
DebugLevel 1

# Listen on all interfaces for gateway access (TCP)
Port 0.0.0.0:1344

# Logging
ServerLog /var/log/c-icap/server.log
AccessLog /var/log/c-icap/access.log

# Echo service (testing/passthrough for REQMOD)
Service echo srv_echo.so

# DLP module for credential detection + domain blocklist + OTT rewriting (REQMOD)
Service polis_dlp srv_polis_dlp.so
ServiceAlias credcheck polis_dlp?allow204=on&allow206=on

# Merged RESPMOD module (ClamAV + OTT approval + value-based exceptions)
Service polis_sentinel_resp /usr/lib/c_icap/srv_polis_sentinel_resp.so
ServiceAlias sentinel_respmod polis_sentinel_resp?allow204=on&allow206=on
