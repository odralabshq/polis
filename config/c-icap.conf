# C-ICAP Configuration for Molis v0.2.5
# Uses SquidClamav for ClamAV malware scanning (fail-closed)

PidFile /var/run/c-icap/c-icap.pid
CommandsSocket /var/run/c-icap/c-icap.ctl
Timeout 300
StartServers 3
MaxServers 10
MinSpareThreads 10
MaxSpareThreads 20
ThreadsPerChild 20

# Listen on all interfaces for gateway access (TCP)
Port 0.0.0.0:1344

# Logging
ServerLog /var/run/c-icap/server.log
AccessLog /var/run/c-icap/access.log

# Echo service (testing/passthrough for REQMOD)
Service echo srv_echo.so

# SquidClamav service for malware scanning
Service squidclamav squidclamav.so

# DLP module for credential detection (REQMOD)
Service molis_dlp srv_molis_dlp.so
ServiceAlias credcheck molis_dlp

# DLP configuration is loaded by the module itself at init time
# (molis_dlp.conf uses a custom format, not c-ICAP config syntax)