file:
  /etc/apt/keyrings/docker.asc:
    exists: true
    contents: null
  /etc/audit/rules.d/docker.rules:
    exists: true
    contents: null
    skip: true
  /etc/docker/daemon.json:
    exists: true
    mode: "0644"
    contents:
    - '"no-new-privileges": true'
    - '"live-restore": true'
    - '"userland-proxy": false'
    - sysbox-runc
  /etc/sysctl.d/99-polis-hardening.conf:
    exists: true
    contents:
    - kernel.randomize_va_space = 2
    - kernel.dmesg_restrict = 1
    - kernel.kptr_restrict = 2
    - fs.suid_dumpable = 0
    - kernel.yama.ptrace_scope = 2
  /etc/systemd/system/polis.service:
    exists: true
    contents:
    - After=docker.service
    - ExecStart=/usr/bin/docker compose up -d
  /opt/polis/config/polis.yaml:
    exists: true
    contents: null
  /opt/polis/docker-compose.yml:
    exists: true
    contents: null
  /opt/polis/scripts/setup-certs.sh:
    exists: true
    mode: "0755"
    contents: null
  /opt/polis/services/gate/config/g3proxy.yaml:
    exists: true
    contents: null
  /opt/polis/services/resolver/config/Corefile:
    exists: true
    contents: null
  /opt/polis/services/sentinel/config/c-icap.conf:
    exists: true
    contents: null
  /opt/polis/services/state/config/valkey.conf:
    exists: true
    contents: null
  /usr/bin/sysbox-fs:
    exists: true
    contents: null
  /usr/bin/sysbox-mgr:
    exists: true
    contents: null
  /usr/bin/sysbox-runc:
    exists: true
    mode: "0755"
    contents: null
package:
  auditd:
    installed: true
  containerd.io:
    installed: true
  docker-ce:
    installed: true
  docker-ce-cli:
    installed: true
  netcat-openbsd:
    installed: true
  sysbox-ce:
    installed: true
service:
  apparmor:
    enabled: true
    running: true
  auditd:
    enabled: true
    running: true
  docker:
    enabled: true
    running: true
  polis:
    enabled: true
    running: null
  sysbox:
    enabled: true
    running: true
command:
  docker-info:
    exec: sudo docker info 2>/dev/null | grep -i runtime
    exit-status: 0
    stdout:
    - sysbox-runc
    stderr: null
    timeout: 0
  docker-version:
    exec: docker --version
    exit-status: 0
    stdout:
    - Docker version
    stderr: null
    timeout: 0
  images-gate:
    exec: sudo docker images | grep -q polis-gate-oss
    exit-status: 0
    stdout: null
    stderr: null
    timeout: 0
  images-resolver:
    exec: sudo docker images | grep -q polis-resolver-oss
    exit-status: 0
    stdout: null
    stderr: null
    timeout: 0
  images-scanner:
    exec: sudo docker images | grep -q polis-scanner-oss
    exit-status: 0
    stdout: null
    stderr: null
    timeout: 0
  images-sentinel:
    exec: sudo docker images | grep -q polis-sentinel-oss
    exit-status: 0
    stdout: null
    stderr: null
    timeout: 0
  images-toolbox:
    exec: sudo docker images | grep -q polis-toolbox-oss
    exit-status: 0
    stdout: null
    stderr: null
    timeout: 0
  images-workspace:
    exec: sudo docker images | grep -q polis-workspace-oss
    exit-status: 0
    stdout: null
    stderr: null
    timeout: 0
  sysbox-runc-version:
    exec: sysbox-runc --version
    exit-status: 0
    stdout:
    - sysbox-runc
    stderr: null
    timeout: 0
  sysctl-aslr:
    exec: sysctl -n kernel.randomize_va_space
    exit-status: 0
    stdout:
    - "2"
    stderr: null
    timeout: 0
  sysctl-dmesg:
    exec: sysctl -n kernel.dmesg_restrict
    exit-status: 0
    stdout:
    - "1"
    stderr: null
    timeout: 0
  sysctl-kptr:
    exec: sysctl -n kernel.kptr_restrict
    exit-status: 0
    stdout:
    - "2"
    stderr: null
    timeout: 0
